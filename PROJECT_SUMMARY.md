# 校园网流量分析与可视化系统 - 项目完成总结

## ✅ 项目完成状态

**项目名称**: 校园网流量分析与可视化系统  
**项目版本**: 1.0 (含完整用户画像模块)  
**完成日期**: 2025 年 12 月 1 日  
**项目状态**: ✅ 所有功能已实现并通过测试

---

## 📦 项目交付物清单

### 核心模块

| 文件名 | 说明 | 行数 | 状态 |
|--------|------|------|------|
| `app.py` | Flask 主程序 | 175 | ✅ |
| `utils/analysis.py` | 流量数据分析与可视化 | 261 | ✅ |
| `utils/user_profile.py` | 用户画像分析（新增）| 378 | ✅ |
| `templates/index.html` | 首页模板 | 95 | ✅ |
| `templates/dashboard.html` | 仪表板模板 | 430 | ✅ |

### 数据文件

| 文件名 | 说明 | 大小 | 状态 |
|--------|------|------|------|
| `data/traffic.csv` | 示例流量数据 | 8.8 KB | ✅ |
| `data/user_profiles.json` | 用户画像输出 | 30 KB | ✅ |

### 配置与文档

| 文件名 | 说明 | 状态 |
|--------|------|------|
| `requirements.txt` | 依赖配置 | ✅ |
| `README.md` | 项目文档 | ✅ |
| `run.sh` | 快速启动脚本 | ✅ |
| `check_project.py` | 项目检查工具 | ✅ |

---

## 🎯 已实现的功能

### 1. 流量数据分析

- ✅ 总流量统计（总字节数、数据包数、用户数、IP 数）
- ✅ 用户流量排名（TOP N）
- ✅ 应用类别流量分布
- ✅ 流量趋势分析（按小时）
- ✅ 活跃时段分析（按小时统计活跃用户数和流量）

### 2. 用户画像分析（新增模块）

**应用标签**:
- ✅ 游戏狂 (游戏流量 > 30%)
- ✅ 视频大户 (视频流量 > 40%)
- ✅ 社交达人 (社交通讯 > 30%)
- ✅ 学习型用户 (教育流量 > 20%)
- ✅ 技术用户 (特殊端口访问 > 20)

**时段标签**:
- ✅ 夜猫子 (夜间流量 > 40%)
- ✅ 早起族 (早晨流量 > 30%)
- ✅ 规律用户 (活跃时间方差小)
- ✅ 波动用户 (活跃时间方差大)

**安全标签**:
- ✅ 可疑扫描 (多端口快速访问)
- ✅ 可疑DNS (DNS 查询次数 > 50)
- ✅ 异常活跃时间 (夜间流量 > 60%)

### 3. 可视化展示

**Plotly 交互式图表**:
- ✅ 流量趋势折线图
- ✅ 应用类别饼图
- ✅ 用户流量排行条形图
- ✅ 活跃时段双轴折线图

**Chart.js 图表**（新增）:
- ✅ 用户应用占比饼图
- ✅ 用户协议占比饼图
- ✅ 用户活跃时段柱状图

### 4. 用户界面

- ✅ 首页 - 文件上传、统计展示
- ✅ 仪表板 - 综合分析页面
- ✅ 用户标签卡片 - 用户特征展示
- ✅ 用户详情面板 - 个别用户深度分析

### 5. API 接口

- ✅ `GET /` - 首页
- ✅ `GET /dashboard` - 仪表板
- ✅ `POST /upload` - 文件上传
- ✅ `GET /api/stats` - 流量统计 API
- ✅ `GET /api/user_profiles` - 用户画像 API

### 6. 文件操作

- ✅ CSV 文件上传和解析
- ✅ 用户画像 JSON 生成和保存
- ✅ 动态加载和刷新

---

## 📊 数据分析结果示例

### 项目中的数据统计

```
流量数据:
  • 总记录数: 102 条
  • 时间范围: 2025-12-01 08:00-17:00
  • 用户数: 75 人
  • 应用类别: 7 种

用户画像:
  • 视频大户: 20.0% (15 用户)
  • 早起族: 18.7% (14 用户)
  • 社交达人: 14.7% (11 用户)
  • 波动用户: 14.7% (11 用户)
```

---

## 🔧 技术栈

### 后端
- **框架**: Flask 3.1.2
- **数据处理**: Pandas 2.3.3
- **Web 服务**: Werkzeug 3.0.1

### 前端
- **样式框架**: Bootstrap 5.1.3
- **交互图表**: Plotly 6.5.0, Chart.js 3.9.1
- **模板引擎**: Jinja2

### 开发工具
- **Python**: 3.8+
- **包管理**: pip

---

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 启动应用
```bash
# 方式 1：使用启动脚本
./run.sh

# 方式 2：直接运行
python3 app.py
```

### 3. 访问应用
打开浏览器访问: **http://localhost:5000**

### 4. 使用功能
- **首页**: 查看总体统计，上传新数据
- **仪表板**: 查看详细分析和图表
- **用户画像**: 向下滚动查看用户标签和详情

---

## 📁 项目结构

```
流量分析/
├── app.py                    # Flask 主应用
├── utils/
│   ├── analysis.py           # 流量分析模块
│   └── user_profile.py       # 用户画像分析模块（新增）
├── templates/
│   ├── index.html            # 首页
│   └── dashboard.html        # 仪表板
├── data/
│   ├── traffic.csv           # 示例数据
│   └── user_profiles.json    # 画像输出
├── static/
│   ├── css/
│   └── js/
├── requirements.txt          # 依赖配置
├── README.md                 # 完整文档
├── run.sh                    # 启动脚本
└── check_project.py          # 项目检查工具
```

---

## ✨ 核心特性

### 用户画像系统

用户画像分析模块对每个用户生成以下信息：

```json
{
  "tags": ["游戏狂", "夜猫子", "可疑DNS"],
  "category_pct": {
    "game": 35.5,
    "video": 20.3,
    "social": 15.2
  },
  "active_hours": {
    "0": {"bytes": 1024000, "count": 10},
    ...
    "23": {"bytes": 512000, "count": 5}
  },
  "protocol_ratio": {
    "TCP": 70.5,
    "UDP": 29.5
  },
  "port_stats": {"22": 5, "3389": 2},
  "dns_stats": {"dns_queries": 45, "dns_bytes": 5120},
  "daily_bytes": {"2025-12-01": 10485760}
}
```

### 标签系统

系统自动为用户生成三类标签：
1. **应用标签** - 用户应用使用习惯
2. **时段标签** - 用户活动时间特征
3. **安全标签** - 潜在的安全威胁识别

---

## 🎓 使用示例

### 运行用户画像分析

```bash
python3 utils/user_profile.py
```

### 通过 API 获取用户画像

```bash
curl http://localhost:5000/api/user_profiles
```

### 上传新数据进行分析

1. 访问首页: http://localhost:5000
2. 点击"上传流量数据"
3. 选择 CSV 文件
4. 系统自动重新分析并生成新的用户画像

---

## 📝 数据格式

### CSV 数据格式

```
timestamp,src_ip,dst_ip,src_port,dst_port,protocol,bytes,app_category,user
2025-12-01 08:00:15,192.168.1.100,8.8.8.8,52341,53,UDP,256,DNS,student_001
2025-12-01 08:00:32,192.168.1.101,142.251.41.14,52456,443,TCP,4096,Social Media,student_002
```

### JSON 输出格式

用户画像数据以 JSON 格式保存在 `data/user_profiles.json`

---

## 🔍 质量保证

### 代码检查
- ✅ Python 语法检查通过
- ✅ 模块导入验证成功
- ✅ 依赖包完整性检查通过

### 功能测试
- ✅ 数据解析功能正常
- ✅ 用户画像生成成功（75 个用户）
- ✅ API 端点响应正常
- ✅ 前端页面渲染正确

### 数据验证
- ✅ CSV 数据完整性确认
- ✅ JSON 数据格式有效
- ✅ 标签生成规则正确执行

---

## 📚 文档

详见项目根目录的 `README.md` 文件，包含：
- 功能概览
- 安装步骤
- API 文档
- 标签体系说明
- 性能优化建议
- 安全建议

---

## 🎉 项目总结

### 成就

✅ 完成了一个功能完整的校园网流量分析系统  
✅ 实现了智能的用户画像识别系统  
✅ 提供了丰富的可视化和交互功能  
✅ 编写了详细的项目文档  
✅ 通过了全面的测试验证  

### 创新点

1. **自动化标签系统** - 自动识别用户行为特征
2. **多维度分析** - 应用、时段、安全三维度分析
3. **实时互动** - 点击卡片即时切换用户详情
4. **可扩展架构** - 易于添加新的分析规则

### 后续改进方向

1. 添加数据库存储支持
2. 实现用户认证和权限控制
3. 支持时间范围查询
4. 添加数据导出功能
5. 实现告警机制
6. 支持更多数据格式

---

## 📞 支持

如有任何问题或建议，请参考 README.md 文档或检查 `check_project.py` 的输出。

---

**项目完成日期**: 2025 年 12 月 1 日  
**最后更新**: 2025 年 12 月 1 日  
**项目状态**: ✅ 已完成
